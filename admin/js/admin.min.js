window.audiotheme=window.audiotheme||{},function(e){_.extend(audiotheme,{template:_.memoize(function(t){var a,i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(n){return a=a||_.template(e("#tmpl-"+t).html(),null,i),a(n)}}),post:function(e,t){return audiotheme.ajax({data:_.isObject(e)?e:_.extend(t||{},{action:e})})},ajax:function(t,a){return _.isObject(t)?a=t:(a=a||{},a.data=_.extend(a.data||{},{action:t})),a=_.defaults(a||{},{type:"POST",url:ajaxurl,context:this}),e.Deferred(function(t){a.success&&t.done(a.success),a.error&&t.fail(a.error),delete a.success,delete a.error,e.ajax(a).done(function(e){("1"===e||1===e)&&(e={success:!0}),_.isObject(e)&&!_.isUndefined(e.success)?t[e.success?"resolveWith":"rejectWith"](this,[e.data]):t.rejectWith(this,[e])}).fail(function(){t.rejectWith(this,arguments)})}).promise()}})}(jQuery),jQuery(function(e){e(".wrap").on("focus",".audiotheme-input-append input",function(){e(this).parent().addClass("is-focused")}).on("blur",".audiotheme-input-append input",function(){e(this).parent().removeClass("is-focused")})}),jQuery(function(e){var t=null,a=null,i=null;e("body").on("click",".thickbox",function(){var n=e(this),r=n.data("insert-field"),d=n.data("insert-button-text");clearInterval(i),r!==void 0&&(t=r),d!==void 0&&(a=d,i=setInterval(function(){var n=e("#TB_iframeContent").contents().find('.button[name^="send"], #insertonlybutton');n.val(a),t.length&&n.off("click").on("click.audiotheme",function(n){var r,d=e(this),o=d.closest("table");n.preventDefault(),o.find("#src").length?r=o.find("#src").val():o.find(".urlfile").length&&(r=e(this).closest("table").find(".urlfile").data("link-url")),jQuery("#"+t).val(r),tb_remove(),t=null,a=null,clearInterval(i)})},500))})}),function(e){var t={init:function(t){var a={items:null};return t&&e.extend(a,t),this.each(function(){var t,i,n=e(this),r=n.find(".audiotheme-repeater-items");n.data("item-template-id")?(i=audiotheme.template(n.data("item-template-id")),a.items&&(n.audiothemeRepeater("clearList"),e.each(a.items,function(e,t){r.append(i(t).replace(/__i__/g,e))})),t=i({}),t=e(t.replace(/__i__/g,"0"))):t=n.find(".audiotheme-repeater-item:eq(0)").clone(),n.data("itemIndex",n.find(".audiotheme-repeater-item").length||0),n.data("itemTemplate",t),n.audiothemeRepeater("updateIndex"),r.sortable({axis:"y",forceHelperSize:!0,forcePlaceholderSize:!0,helper:function(t,a){var i=a.clone();return i.children().each(function(t){e(this).width(a.children().eq(t).width())}),i},update:function(){n.audiothemeRepeater("updateIndex")},change:function(){n.find(".audiotheme-repeater-sort-warning").fadeIn("slow")}}),n.find(".audiotheme-repeater-add-item").on("click",function(t){t.preventDefault(),e(this).closest(".audiotheme-repeater").audiothemeRepeater("addItem")}),n.on("click",".audiotheme-repeater-remove-item",function(t){var a=e(this).closest(".audiotheme-repeater");t.preventDefault(),e(this).closest(".audiotheme-repeater-item").remove(),a.audiothemeRepeater("updateIndex")}),n.on("blur","input,select,textarea",function(){e(this).closest(".audiotheme-repeater").find(".audiotheme-repeater-item").removeClass("audiotheme-repeater-active-item")}).on("focus","input,select,textarea",function(){e(this).closest(".audiotheme-repeater-item").addClass("audiotheme-repeater-active-item").siblings().removeClass("audiotheme-repeater-active-item")})})},addItem:function(){var t=e(this),a=t.data("itemIndex"),i=t.data("itemTemplate");t.audiothemeRepeater("clearList"),t.find(".audiotheme-repeater-items").append(i.clone()).children(":last-child").find("input,select,textarea").each(function(){var t=e(this);t.attr("name",t.attr("name").replace("[0]","["+a+"]"))}).end().find(".audiotheme-clear-on-add").val("").end().find(".audiotheme-remove-on-add").remove().end().find(".audiotheme-show-on-add").show().end().find(".audiotheme-hide-on-add").hide().end(),t.data("itemIndex",a+1).audiothemeRepeater("updateIndex"),t.trigger("addItem.audiotheme",[t.find(".audiotheme-repeater-items").children().last()])},clearList:function(){var t=e(this).find(".audiotheme-repeater-items");t.hasClass("is-empty")&&t.removeClass("is-empty").html("")},updateIndex:function(){e(".audiotheme-repeater-index",this).each(function(t){e(this).text(t+1+".")})}};e.fn.audiothemeRepeater=function(a){return t[a]?t[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?(e.error("Method "+a+" does not exist on jQuery.audiothemeRepeater"),void 0):t.init.apply(this,arguments)}}(jQuery);